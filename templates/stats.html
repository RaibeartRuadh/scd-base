{% extends "base.html" %}

{% block title %}–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö - –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Ç–∞–Ω—Ü–µ–≤{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ Ru-SCDDB</h1>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
    <div class="row mb-4">
        <div class="col-md-3">
            <div class="card text-center bg-primary text-white">
                <div class="card-body">
                    <h2 class="display-4">{{ total_dances }}</h2>
                    <p class="card-text">–í—Å–µ–≥–æ —Ç–∞–Ω—Ü–µ–≤</p>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card text-center bg-success text-white">
                <div class="card-body">
                    <h2 class="display-4">{{ total_dance_types }}</h2>
                    <p class="card-text">–¢–∏–ø–æ–≤ —Ç–∞–Ω—Ü–µ–≤</p>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card text-center bg-warning text-dark">
                <div class="card-body">
                    <h2 class="display-4">{{ total_set_types }}</h2>
                    <p class="card-text">–¢–∏–ø–æ–≤ —Å–µ—Ç–æ–≤</p>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card text-center bg-info text-white">
                <div class="card-body">
                    <h2 class="display-4">{{ total_dance_formats }}</h2>
                    <p class="card-text">–§–æ—Ä–º–∞—Ç–æ–≤ —Å–µ—Ç–æ–≤</p>
                </div>
            </div>
        </div>
    </div>

    <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ç–∏–ø–∞–º —Ç–∞–Ω—Ü–µ–≤ -->
    <div class="row">
        <div class="col-md-6">
            <div class="card">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0">–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Ç–∏–ø–∞–º —Ç–∞–Ω—Ü–µ–≤</h5>
                </div>
                <div class="card-body">
                    {% if dance_type_stats %}
                    <div class="table-responsive">
                        <table class="table table-striped table-sm">
                            <thead>
                                <tr>
                                    <th>–¢–∏–ø —Ç–∞–Ω—Ü–∞</th>
                                    <th>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</th>
                                    <th>–ü—Ä–æ—Ü–µ–Ω—Ç</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for type_name, count in dance_type_stats %}
                                <tr>
                                    <td>
                                        <span class="badge badge-type 
                                            {% if type_name == 'Reel' %}bg-primary
                                            {% elif type_name == 'Jig' %}bg-success
                                            {% elif type_name == 'Strathspey' %}bg-warning
                                            {% else %}bg-secondary{% endif %}">
                                            {{ type_name }}
                                        </span>
                                    </td>
                                    <td><strong>{{ count }}</strong></td>
                                    <td>
                                        <div class="progress">
                                            <div class="progress-bar 
                                                {% if type_name == 'Reel' %}bg-primary
                                                {% elif type_name == 'Jig' %}bg-success
                                                {% elif type_name == 'Strathspey' %}bg-warning
                                                {% else %}bg-secondary{% endif %}" 
                                                style="width: {{ (count / total_dances * 100) if total_dances > 0 else 0 }}%">
                                                {{ "%.1f"|format((count / total_dances * 100) if total_dances > 0 else 0) }}%
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                    {% else %}
                    <div class="text-center py-4">
                        <p class="text-muted">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ —Ç–∏–ø–∞—Ö —Ç–∞–Ω—Ü–µ–≤</p>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ç–∏–ø–∞–º —Å–µ—Ç–æ–≤ -->
        <div class="col-md-6">
            <div class="card">
                <div class="card-header bg-success text-white">
                    <h5 class="mb-0">–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Ç–∏–ø–∞–º —Å–µ—Ç–æ–≤</h5>
                </div>
                <div class="card-body">
                    {% if set_type_stats %}
                    <div class="table-responsive">
                        <table class="table table-striped table-sm">
                            <thead>
                                <tr>
                                    <th>–¢–∏–ø —Å–µ—Ç–∞</th>
                                    <th>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</th>
                                    <th>–ü—Ä–æ—Ü–µ–Ω—Ç</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for type_name, count in set_type_stats %}
                                <tr>
                                    <td><strong>{{ type_name }}</strong></td>
                                    <td><strong>{{ count }}</strong></td>
                                    <td>
                                        <div class="progress">
                                            <div class="progress-bar bg-info" 
                                                style="width: {{ (count / total_dances * 100) if total_dances > 0 else 0 }}%">
                                                {{ "%.1f"|format((count / total_dances * 100) if total_dances > 0 else 0) }}%
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                    {% else %}
                    <div class="text-center py-4">
                        <p class="text-muted">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ —Ç–∏–ø–∞—Ö —Å–µ—Ç–æ–≤</p>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>

    <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ñ–æ—Ä–º–∞—Ç–∞–º —Å–µ—Ç–æ–≤ -->
    <div class="row mt-4">
        <div class="col-12">
            <div class="card">
                <div class="card-header bg-warning text-dark">
                    <h5 class="mb-0">–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Ñ–æ—Ä–º–∞—Ç–∞–º —Å–µ—Ç–æ–≤</h5>
                </div>
                <div class="card-body">
                    {% if dance_format_stats %}
                    <div class="table-responsive">
                        <table class="table table-striped table-sm">
                            <thead>
                                <tr>
                                    <th>–§–æ—Ä–º–∞—Ç —Å–µ—Ç–∞</th>
                                    <th>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</th>
                                    <th>–ü—Ä–æ—Ü–µ–Ω—Ç</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for format_name, count in dance_format_stats %}
                                <tr>
                                    <td><strong>{{ format_name }}</strong></td>
                                    <td><strong>{{ count }}</strong></td>
                                    <td>
                                        <div class="progress">
                                            <div class="progress-bar bg-warning" 
                                                style="width: {{ (count / total_dances * 100) if total_dances > 0 else 0 }}%">
                                                {{ "%.1f"|format((count / total_dances * 100) if total_dances > 0 else 0) }}%
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                    {% else %}
                    <div class="text-center py-4">
                        <p class="text-muted">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ —Ñ–æ—Ä–º–∞—Ç–∞—Ö —Å–µ—Ç–æ–≤</p>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>

    <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–∏—Å—Ç–µ–º–µ -->
    <div class="row mt-4">
        <div class="col-md-6">
            <div class="card">
                <div class="card-header bg-secondary text-white">
                    <h5 class="mb-0">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–∏—Å—Ç–µ–º–µ</h5>
                </div>
                <div class="card-body">
                    <table class="table table-sm">
                        <tr>
                            <td><strong>–¢–∏–ø –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:</strong></td>
                            <td><span class="badge bg-info">{{ db_type }}</span></td>
                        </tr>
                        <tr>
                            <td><strong>–í—Å–µ–≥–æ –∑–∞–ø–∏—Å–µ–π:</strong></td>
                            <td><strong>{{ total_dances }}</strong></td>
                        </tr>
                        <tr>
                            <td><strong>–¢–∏–ø–æ–≤ —Ç–∞–Ω—Ü–µ–≤:</strong></td>
                            <td><strong>{{ total_dance_types }}</strong></td>
                        </tr>
                        <tr>
                            <td><strong>–¢–∏–ø–æ–≤ —Å–µ—Ç–æ–≤:</strong></td>
                            <td><strong>{{ total_set_types }}</strong></td>
                        </tr>
                        <tr>
                            <td><strong>–§–æ—Ä–º–∞—Ç–æ–≤ —Å–µ—Ç–æ–≤:</strong></td>
                            <td><strong>{{ total_dance_formats }}</strong></td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- –ü—É—Å—Ç–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
    {% if total_dances == 0 %}
    <div class="row mt-4">
        <div class="col-12">
            <div class="card">
                <div class="card-body text-center py-5">
                    <div class="mb-3">
                        <span style="font-size: 4rem;">üìä</span>
                    </div>
                    <h4>–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø—É—Å—Ç–∞</h4>
                    <p class="text-muted">–î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤—ã–µ —Ç–∞–Ω—Ü—ã, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É</p>
                    <a href="{{ url_for('add_dance') }}" class="btn btn-primary btn-lg">
                        –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–≤—ã–π —Ç–∞–Ω–µ—Ü
                    </a>
                </div>
            </div>
        </div>
    </div>
    {% endif %}
</div>
{% endblock %}